name: Build controller for cortex

on:
  push:
    branches: [ "master", "joel-interview" ]
  pull_request:
    branches: [ "master", "joel-interview" ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Apt update
      run: sudo apt update

    - name: Install dependencies
      run: sudo apt install -y build-essential binutils-arm-none-eabi gcc-arm-none-eabi python2

    - name: Make python2 default
      run: update-alternatives --install /usr/bin/python python /usr/bin/python2.7 1

    - name: Run check
      run:  make -C controller/build/ble5-ctr/gcc/ CPU=cortex-m4

